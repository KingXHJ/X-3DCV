# 01 结构光前奏：双目立体匹配算法
- 本课程重建算法的精度在40-50um左右

## 目录
- [1 引入双目视觉的原因](#1-引入双目视觉的原因)
- [2 理想双目测距模型](#2-理想双目测距模型)
- [3 实际双目测距模型](#3-实际双目测距模型)
- [4 双目视觉的优缺点](#4-双目视觉的优缺点)
- [5 加入结构光需要解决的问题](#5-加入结构光需要解决的问题)


## 1 引入双目视觉的原因
1. 解决单目尺度不确定性
1. 模仿人眼的成像结构

## 2 理想双目测距模型
- 已经拥有同名点的情况下，处理两个数值
    1. 深度方向
    1. 高度方向
- 通过标定得到相机焦距 f 和相机基线 b （两台相机之间的距离），依照同名点存在的 ***视差*** ，能够依次计算得到深度值 z，偏移 x 和高度 y
- 尽管双目相机的内参无法做到完全一致，但是分辨率和相机焦距这两个参数尽量保持一致，否则影响重建精度

## 3 实际双目测距模型
1. 确定同名点的方式（也是为了计算视差）
    1. 检测两幅图像上各自的特征点
    1. 对这些特征点的关系进行匹配，计算它们之间的相似度距离
        - 通过描述子（SIFT、SURF、ORB等，得到的16/128维特征向量）计算向量距离

1. 解决特征点寻找同名点效率低下
    1. 问题：
        1. 特征点的暴力匹配
        1. 倾斜的极线消耗计算资源
    1. 解决方法：
        1. 通过极线校正使得两个平面平行，成为理想双目测距模型

1. 解决特征匹配中的问题
    1. 问题：
        1. 左图中的一点，由于校正后误差的存在，右图中的对应点不一定恰好在极限上
        1. 单个像素点进行比较，鲁棒性很差，很容易被光照变化和视角变化所影响
    1. 解决：
        1. 采用滑动窗口匹配法，寻找SSD（能量）最低的一点，认为是匹配点

1. 单目和双目标定的作用
    1. 单目标定：把畸变的相机校准为理想模型。因为实际相机是存在畸变的；除此之外还有标定相机内参的作用，比如计算模型中焦距 f 参数
    1. 双目标定：知道两部相机的相对位置关系。因为实际两部相机的光轴是不平行的，而且要通过图像校正将相机“虚拟”地平移到了同一个平面上

## 4 双目视觉的优缺点
1. 优点：
    1. 对硬件要求低、成本低：只需要两台普通相机，不需要像TOF、结构光那样特殊的发射器、接收器
    1. 室内外均适用：只要能采集到的图像，都能进行重建，而TOF、结构光就很难在室外适用
1. 缺点
    1. 对环境光照敏感：（这应该是大多数重建算法的共同缺点，算法都很难适应包括：光线过强、较暗情况）
    1. 完全不适用于单调缺乏纹理的场景：如天空、白墙、沙漠等，都会出现匹配困难（但事实上，无论是结构光、TOF方法，都会有自己算法的局限性，比如结构光测量镜面反射物体）
    1. 计算复杂度太高：由于是纯视觉方法，每个像素点去寻找自己相应的匹配点，即使经过优化，也需要沿着一条线去搜索，算法复杂度依然很高。另外，为了保证匹配结果鲁棒性，算法中还会增加大量错误剔除策略。基于这两点，很难去实现一个可靠商用的算法
    1. 算法精度不高：有两方面原因：
        - 匹配的精度本就不高，受环境光影响较大；
        - 根据深度公式，其精度很大程度上取决于基线


## 5 加入结构光需要解决的问题
    1. 对环境光照敏感
    1. 单调缺乏纹理的场景


[02-Monocular-Calibration](./02-Monocular-Calibration.md)